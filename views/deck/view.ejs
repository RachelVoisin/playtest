<%- include('../partials/header'); %>

<p><%= deck.name %></p>
<p><%= deck.format %></p>
<p><%= deck.dateUpdated %></p>
<div style="width:15px;height:15px;background-color:<%= deck.color %>;"></div>

<div>
    <select class="jsSort">
        <option value="type">type</option>
        <option value="cmc">cmc</option>
        <option value="color">color</option>
    </select>

    <label>Overlap Categories: </label>
    <input class="jsOverlap" type="checkbox" checked> 
</div>

<div>
    <% sortedCards.forEach(function(section){ %>
        <h3><%= section.subtitle %></h3>
        <% section.cards.forEach(function(card){ %>
            <p><%= card.name %></p>
        <% }); %>
    <% }); %>
</div>
<br />
<div>
    <% deck.maybeCards.forEach(function(card){ %>
        <p><%= card.name %></p>
    <% }); %>
</div>

<script>
    $(document).ready(function() {
        const queryString = window.location.search;
        const urlParams   = new URLSearchParams(queryString);
        const sortType    = urlParams.get('sort') || "type";
        const overlap     = urlParams.get('overlap');

        $('.jsSort').val(sortType);

        if(overlap == "false") {
            $(".jsOverlap").prop('checked', false); 
        }

        $(".jsSort").on("change", function() {
            update();
        });

        $(".jsOverlap").on("click", function() {
            update();
        });

        function update() {
            var sortOption   =  $('.jsSort').val();
            var overlapOption = $(".jsOverlap").prop('checked') == true ? 'true' : 'false';

            window.location.href = "<%= baseUrl %>/deck/view/<%= deck.id %>?" + "&sort=" + sortOption + "&overlap=" + overlapOption;
        }
    });
    
</script>

<%- include('../partials/footer'); %>